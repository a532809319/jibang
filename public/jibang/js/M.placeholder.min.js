/*!
*作者：毛贤德
*说明：	placeholder兼容ie7 8 9
*时间：2016-8-10 15:02
*QQ:394097441
*url: http://www.aifou.net
注意，如果resetVal参数为flase时，ajax提交表单，要调用 $("form").trigger('m-placeholder'); 给表单$("form").serialize()处理值
*/
(function(a,b){b.fn.extend({placeholder:function(l){var g={auto:true,tabName:"input,textarea",color:"#ccc",pclass:"m-isPlaceholder",resetVal:true};a.extend(g,l);var f=false,c=0;if(g.auto){var r=document.createElement("input");f="placeholder" in r}if(f){return false}if(!b.__placeholder__pass){b.__placeholder__pass=0}var p=g.tabName.toLowerCase();p=p.split(",");var o={};for(var h in p){o[a.trim(p[h])]=1}p=null;delete p;var s;if(this.selector){s=a(this)}else{var t="";for(var h in o){t+=h+"[placeholder],"}t=t.substring(0,t.length-1);s=a(t);t=null;delete t}function k(i){i.data("isPlaceholder",false);i.removeClass(g.pclass);i.css("color",i.data("color"))}function u(){var i=a(this);if(i.data("isPlaceholder")){i.val("");k(i)}}function j(){var i=a(this),n=i.val();if(n==""){i.val(i.data("placeholder")).data("isPlaceholder",true);i.addClass(g.pclass);i.css("color",g.color)}}function d(){var v=a(this);if(v.attr("type")!="password"){v=a('[m-placeholder-pass="'+v.attr("m-placeholder-pass-p")+'"]')}if(v.val()==""){var n=v.attr("m-placeholder-pass");v.hide();var i=a('[m-placeholder-pass-p="'+n+'"]');i.show().val(v.data("placeholder")).addClass(g.pclass)}}function e(){var i=a(this);a('[m-placeholder-pass="'+i.hide().removeClass(g.pclass).attr("m-placeholder-pass-p")+'"]').show().focus()}var m=[];s.each(function(n,v){var w=a(this);if(o[w.prop("tagName").toLowerCase()]&&!w.data("m-placeholder")){w.data("color",w.css("color"));w.data("placeholder",w.attr("placeholder"));w.removeAttr("placeholder");if("password"==w.attr("type")){b.__placeholder__pass++;w.after(w.prop("outerHTML").replace(/type[ ]*?=[ ]*?(["']*?)password\1/,'type="text" m-placeholder-pass-p="'+b.__placeholder__pass+'"'));w.attr("m-placeholder-pass",b.__placeholder__pass);var i=a('[m-placeholder-pass-p="'+b.__placeholder__pass+'"]');i.bind({"focus.placeholder":e}).removeAttr("name").removeAttr("id").css("color",g.color).width(w.width()).hide();w.bind({"blur.placeholder":d}).data("m-placeholder",true).trigger("blur.placeholder")}else{w.bind({"focus.placeholder":u,"blur.placeholder":j}).data("m-placeholder",true).trigger("blur.placeholder")}m.push(w)}});a(window).bind("beforeunload",function(){for(var n in m){if(m[n].data("isPlaceholder")){m[n].val("")}}});function q(){var i=a("."+g.pclass,this).not("[m-placeholder-pass-p]");i.each(function(n,v){a(this).val("")});setTimeout(function(){i.each(function(n,v){a(this).trigger("blur.placeholder")})},100)}a(document).delegate("form","submit.placeholder",q);a("form").on("m-placeholder",q);if(g.resetVal){a.prototype.val=function(i){return function(){if(this.data("isPlaceholder")){if((typeof arguments[0]=="undefined")){return""}k(this)}return i.apply(this,arguments)}}(a.prototype.val)}}})})(jQuery,MaoXianDe);